<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Información de Vuelos</title>
    <style>
        /* Estilos básicos para la visualización de los vuelos */
        body {
            font-family: Arial, sans-serif;
            background-color: #222;
            color: #fff;
            margin: 0;
            padding: 20px;
        }
        .flight-item {
            background-color: #333;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        #real-flights-container {
            margin-top: 20px;
        }
        button {
            background-color: #28a745;
            color: white;
            padding: 10px 20px;
            border: none;
            cursor: pointer;
            font-size: 16px;
            border-radius: 5px;
        }
        button:hover {
            background-color: #218838;
        }
    </style>
</head>
<body>

    <h1>Vuelos en el Aeropuerto de Cancún</h1>
    <button id="fetch-real-flights">Obtener vuelos reales</button>

    <div id="real-flights-container"></div>

    <script>
        // Clase para gestionar los vuelos
        class FlightManager {
            static flights = [];

            // Obtener vuelos reales
            static fetchRealFlights() {
                const url = `https://api.aviationstack.com/v1/flights?access_key=57aace98567be4f24ac10edd56776d28&dep_iata=CUN`; // Usando HTTPS

                fetch(url)
                    .then(response => response.json())
                    .then(data => {
                        console.log(data); // Verificar los datos recibidos
                        if (data && data.data && Array.isArray(data.data)) {
                            this.saveFlights(data.data);
                            this.updateDisplay();
                        } else {
                            console.error('No se encontraron vuelos o error en la API');
                        }
                    })
                    .catch(error => {
                        console.error('Error al obtener vuelos:', error);
                    });
            }

            // Guardar vuelos obtenidos
            static saveFlights(flightsData) {
                this.flights = flightsData.map(flight => ({
                    iata: flight.iata || 'Desconocido',  // Verificación de 'iata'
                    destination: flight.destination || 'Desconocido',  // Verificación de destino
                    departure: flight.departure ? new Date(flight.departure).toLocaleTimeString() : 'Desconocido',  // Formato de hora
                }));
            }

            // Actualizar la interfaz con los vuelos
            static updateDisplay() {
                const flightsContainer = document.getElementById("real-flights-container");
                flightsContainer.innerHTML = '';  // Limpiar contenido anterior

                this.flights.forEach(flight => {
                    if (flight && flight.iata) {  // Asegurarnos de que 'iata' esté presente
                        const flightElement = document.createElement('div');
                        flightElement.classList.add('flight-item');
                        flightElement.innerHTML = `
                            <p><strong>Vuelo:</strong> ${flight.iata}</p>
                            <p><strong>Destino:</strong> ${flight.destination}</p>
                            <p><strong>Hora:</strong> ${flight.departure}</p>
                        `;
                        flightsContainer.appendChild(flightElement);
                    }
                });
            }
        }

        // Llamada para obtener vuelos reales
        document.getElementById('fetch-real-flights').addEventListener('click', () => {
            FlightManager.fetchRealFlights();
        });
    </script>

</body>
</html>
